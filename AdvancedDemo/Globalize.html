<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="John Reilly">
    <meta name="keywords" content="jQuery Validation Unobtrusive Native, ASP.Net MVC, validation, jQuery, jquery-validate.js, unobtrusive">
    <title>Globalize - jQuery Validation Unobtrusive Native</title>
    
    <meta name="Description" content="A demo of internationalized / locale-specific validation using Globalize.">

    <link href="../Content/site.css" rel="stylesheet"/>

    <link href="https://google-code-prettify.googlecode.com/svn/loader/prettify.css" rel="stylesheet" />
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
    
    <script src="../Scripts/modernizr-2.8.3.js"></script>

</head>
<body>

    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../index.html">jVUN</a>
            </div>

            <div class="collapse navbar-collapse navbar-responsive-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="../Home/GettingStarted.html">Getting Started</a></li>
                    <li><a href="http://blog.icanmakethiswork.io/2013/10/migrating-from-jquery.validate.unobtrusive.js-to-jQuery.Validation.Unobtrusive.Native.html" target="_blank">Migrating</a></li>
                    <li><a href="../Home/Download.html">Download</a></li>
                    <li class="dropdown">
                        <a href="Globalize.html#" class="dropdown-toggle" data-toggle="dropdown">Demos <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="../Demo.html">Overview</a></li>
                            <li class="divider"></li>
                            <li class="dropdown-header">Type Validations</li>
<li><a href="../Demo/Number.html">Number</a></li>
<li><a href="../Demo/Date.html">Date</a></li>
<li class="dropdown-header">Attribute Validations</li>
<li><a href="../Demo/Required.html">Required</a></li>
<li><a href="../Demo/Range.html">Range</a></li>
<li><a href="../Demo/MaxLengthMinLength.html">MaxLength / MinLength</a></li>
<li><a href="../Demo/EqualTo.html">EqualTo</a></li>
<li><a href="../Demo/Url.html">URL</a></li>
<li><a href="../Demo/Email.html">Email</a></li>
<li><a href="../Demo/CreditCard.html">CreditCard</a></li>
<li><a href="../Demo/Remote.html">Remote</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="Globalize.html#" class="dropdown-toggle" data-toggle="dropdown">Advanced Demos <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="../AdvancedDemo.html">Overview</a></li>
                            <li class="divider"></li>
                            <li><a href="Knockout.html">Knockout</a></li>
<li><a href="CustomValidation.html">Custom Validation</a></li>
<li class="dropdown-header">Miscellaneous Demos</li>
<li><a href="Tooltip.html">Tooltip</a></li>
<li class="active"><a href="Globalize.html">Globalize</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div id="main" class="container">

        

<h3>Globalize</h3>

<p>If you want to patch the jQuery Validation date and number validation to be locale specific then you can using <code>jquery.validate.globalize.js</code>.  You can download it from Nuget here:</p>

<div class="nuget-badge">
    <p><code>PM&gt; Install-Package jQuery.Validation.Globalize</code></p>
</div>

<p>To find more information about this then you could have a read of my <a href="http://blog.icanmakethiswork.io/2012/09/globalize-and-jquery-validate.html" target="_blank">blogpost</a> or look at the project on <a href="https://github.com/johnnyreilly/jquery-validation-globalize" target="_blank">GitHub</a>.  This library replaces the jQuery Validation date and number validation with an implementation that depends on <a href="http://github.com/jquery/globalize" target="_blank">Globalize</a>.</p>

<p>Take a look at the demo below, customised for the <strong>en-US</strong> culture - that's right, *<strong>your</strong>* culture (or at least what ASP.Net thinks your culture ought to be).  If you switch your browser to say, <strong>de-DE</strong> and reload this page then you'll see the app has switched to the closest Globalize appropriate culture it can find.</p>

<div class="alert alert-danger alert-block" style="display: none;" id="warning">
    <h4>This demo is fixed to the current culture</h4>
    <p>Hey people - it looks like you're viewing a static version of this page.  (GitHub pages is all about the static content you see.)  If you want to switch cultures as suggested above then try running the jVUNDemo project locally.  Then it's all goodness I promise.</p>
</div>

<ul class="nav nav-tabs" data-tabs="tabs">
    <li class="active"><a data-toggle="tab" href="Globalize.html#demo">Demo</a></li>
    <li><a data-toggle="tab" href="Globalize.html#model">Model</a></li>
    <li><a data-toggle="tab" href="Globalize.html#view">View</a></li>
    <li><a data-toggle="tab" href="Globalize.html#html">HTML</a></li>
    <li><a data-toggle="tab" href="Globalize.html#javascript">JavaScript</a></li>
    <li><a data-toggle="tab" href="Globalize.html#culture">Determine which culture to use</a></li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="demo">
<form action="Globalize.html" method="post">            <div class="row">
                <label for="Double">Double - a number between 10.5 and 20.3 must be entered: </label>
                <input data-msg-number="The field Double must be a number." data-msg-range="The field Double must be between 10.5 and 20.3." data-msg-required="The Double field is required." data-rule-number="true" data-rule-range="[10.5,20.3]" data-rule-required="true" id="Double" name="Double" type="text" value="0" />
            </div>
            <div class="row">
                <label for="DateTime">DateTime - example date string: 2/7/2015, example date and time string: Saturday, February 7, 2015 12:00 AM:</label>
                <input data-msg-date="The field DateTime must be a date." data-msg-required="The DateTime field is required." data-rule-date="true" data-rule-required="true" id="DateTime" name="DateTime" type="text" value="" />
            </div>
            <div class="row">
                <button type="submit" class="btn btn-default">Submit</button>
                <button type="reset" class="btn btn-info">Reset</button>
            </div>
</form>
    </div>

    <div class="tab-pane" id="model">
        
        <p>Here's the model, note that the <code>Range</code> attribute decorates the decimal property and a <code>Required</code> attribute decorates our nullable DateTime.:</p>

        <pre class="prettyprint cs">
    using System.ComponentModel.DataAnnotations;

    namespace jQuery.Validation.Unobtrusive.Native.Demos.Models
    {
        public class GlobalizeModel
        {
            [Range(10.5D, 20.3D)]
            public decimal Double { get; set; }

            [Required]
            public DateTime? DateTime { get; set; }
        }
    }
        </pre>
    </div>

    <div class="tab-pane" id="view">
        
        <p>Here's the view (which uses the model):</p>

        <pre class="prettyprint cs">
    @model jQuery.Validation.Unobtrusive.Native.Demos.Models.GlobalizeModel
    @using (Html.BeginForm())
    {
        &lt;div class="row"&gt;
            @Html.LabelFor(x =&gt; x.Double, string.Format("Double - a number between {0} and {1} must be entered: ",10.5D, 20.3D))
            @Html.TextBoxFor(x =&gt; x.Double, true)
        &lt;/div&gt;

        &lt;div class="row"&gt;
            @Html.LabelFor(x =&gt; x.DateTime, string.Format("DateTime - example date string: {0:d}, example date and time string: {0:f}:", DateTime.Today))
            @Html.TextBoxFor(x =&gt; x.DateTime, true)
        &lt;/div&gt;

        &lt;div class="row"&gt;
            &lt;button type="submit" class="btn btn-default"&gt;Submit&lt;/button&gt;
            &lt;button type="reset" class="btn btn-info"&gt;Reset&lt;/button&gt;
        &lt;/div&gt;
    }
        </pre>

    </div>

    <div class="tab-pane" id="html">
        
        <p>Here's the HTML that the view generates:</p>

        <pre class="prettyprint html">
    &lt;form action="/AdvancedDemo/Globalize" method="post"&gt;
        &lt;div class="row"&gt;
            &lt;label for="Double"&gt;Double - a number between 10.5 and 20.3 must be entered: &lt;/label&gt;
            &lt;input data-msg-number="The field Double must be a number." 
                data-msg-range="The field Double must be between 10.5 and 20.3." 
                data-msg-required="The Double field is required." 
                data-rule-number="true" 
                data-rule-range="[10.5,20.3]" 
                data-rule-required="true" 
                id="Double" name="Double" type="text" value="0" /&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;label for="DateTime"&gt;DateTime - example date string: 2/7/2015, example date and time string: Saturday, February 7, 2015 12:00 AM:&lt;/label&gt;
            &lt;input data-msg-date="The field DateTime must be a date." 
                data-msg-required="The DateTime field is required." 
                data-rule-date="true" 
                data-rule-required="true" 
                id="DateTime" name="DateTime" type="text" value="" /&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;button type="submit" class="btn btn-default"&gt;Submit&lt;/button&gt;
            &lt;button type="reset" class="btn btn-info"&gt;Reset&lt;/button&gt;
        &lt;/div&gt;
    &lt;/form&gt;
        </pre>
    </div>
    
    <div class="tab-pane" id="javascript">
        
        <p>Here's an example of the scripts that you might serve up if you wanted to use <code>jquery.validate.globalize.js</code>.  Note that <code>jquery.validate.globalize.js</code> is last as it depends on both <code>jquery.validate.js</code> and <code>globalize.js</code>.</p>

        <pre class="prettyprint html">
  &lt;script src="/Scripts/jquery.validate.js"&gt;&lt;/script&gt;
  &lt;script src="/Scripts/jquery.globalize/globalize.js"&gt;&lt;/script&gt;
  &lt;script src="/scripts/jquery.globalize/cultures/globalize.culture.en-GB.js"&gt;&lt;/script&gt;
  &lt;script src="/Scripts/jquery.validate.globalize.js"&gt;&lt;/script&gt;
        </pre>

        <p>Here's the JavaScript that initialises the validation - notice it also initialises Globalize to your culture:</p>

        <pre class="prettyprint js">
  // Initialise Globalize to the current UI culture (you need to have served up the relevant culture file for this to work)
  Globalize.culture("en-US");

  $("form").validate({
      submitHandler: function (form) {
          alert("This is a valid form!");
      }
  });
        </pre>

    </div>
     
    <div class="tab-pane" id="culture">
        
        <p>You may wonder how this page is determining which culture to use.  Well it's using this function here:</p>

        <pre class="prettyprint cs">
    // Identifies and returns the culture Globalize should use and it's file path in a KeyValuePair where:
    // Key = culture to use (eg "en-GB")
    // Value = culture file to use (eg "~/scripts/jquery.globalize/cultures/globalize.culture.en-GB.js")
    public KeyValuePair&lt;string, string&gt; GlobalizeCulture()
    { 
        // Determine culture - GUI culture for preference, user selected culture as fallback
        const string filePattern = "~/scripts/jquery.globalize/cultures/globalize.culture.{0}.js";
        var currentCulture = CultureInfo.CurrentCulture;
        var cultureToUse = "en-GB"; //Default regionalisation to use
 
        //Try to pick a more appropriate regionalisation
        if (File.Exists(HostingEnvironment.MapPath(string.Format(filePattern, currentCulture.Name)))) //First try for a globalize.culture.en-GB.js style file
            cultureToUse = currentCulture.Name;
        else if (File.Exists(HostingEnvironment.MapPath(string.Format(filePattern, currentCulture.TwoLetterISOLanguageName)))) //That failed; now try for a globalize.culture.en.js style file
            cultureToUse = currentCulture.TwoLetterISOLanguageName;
 
        return new KeyValuePair&lt;string, string&gt;(cultureToUse, string.Format(filePattern, cultureToUse));
    }        
        </pre>
        
        <p>This takes the current culture that ASP.Net believes you are running as and then looks for a Globalize culture that is a close match (finally falling back to en-GB if it finds nothing suitable). Do note that this depends on the following setting in the <code>web.config</code>:</p>
        
        <pre class="prettyprint xml">
&lt;configuration&gt;
  &lt;system.web&gt;
    &lt;globalization culture="auto" uiCulture="auto" /&gt;
    &lt;!--- Other stuff.... --&gt;
  &lt;/system.web&gt;
&lt;/configuration&gt;

        </pre>
        
        <p>The Key returned from the function is the Globalize culture you are going to use (eg "<strong>en-US</strong>") which you can use to initialise Globalize to the relevant culture.  The Value returned is the Globalize culture file you are going to use (eg <strong>"~/scripts/globalize/cultures/globalize.culture.en-US.js</strong>") which you can use to serve up that culture file.  These 2 combined allows you to do something like this:</p>
        
        <pre class="prettyprint html">
    @{
        var culture = GlobalizeCulture();
    }

    @Scripts.Render(
        "~/bundles/jquery-validation", 
        "~/Scripts/jquery.globalize/globalize.js", 
        culture.Value, // eg "~/scripts/jquery.globalize/cultures/globalize.culture.en-GB.js"
        "~/Scripts/jquery.validate.globalize.js")

    &lt;script&gt;
        // Initialise Globalize to the current UI culture
        Globalize.culture("@culture.Key"); // eg "en-GB"

        // ....

    &lt;/script&gt;

        </pre>
    </div>

</div>



    </div>

    <div id="footer">
        <div class="container">
            <p class="muted">
                &#169; 2013 <a href="http://blog.icanmakethiswork.io" target="_blank">John Reilly</a>
                · <a href="mailto:johnny_reilly@hotmail.com">Contact</a>
                · <a href="../Home/License.html">License</a>
            </p>
        </div>
    </div>

    <script src="../Scripts/jquery-1.11.2.js"></script>
<script src="../Scripts/bootstrap.js"></script>

    
    <script src="../Scripts/jquery.validate.js"></script>
<script src="../Scripts/globalize/globalize.js"></script>
<script src="../scripts/globalize/cultures/globalize.culture.en-US.js"></script>
<script src="../Scripts/jquery.validate.globalize.js"></script>

    <script>
        // Initialise Globalize to the current UI culture
        Globalize.culture("en-US");

        $("form").validate({
            submitHandler: function (form) {
                alert("This is a valid form!");
            }
        });

        // Show warning if this is a static page
        if (window.location.href.toLowerCase().indexOf("globalize.html") !== -1) {
            $("#warning").slideDown();
        }
    </script>

    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <a href="https://github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native" class="hidden-xs"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</body>
</html>
